<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><base href="../"><link rel="stylesheet" href="dmdoc.css"><title>/datum/say_message - Goonstation 13</title></head><body><header><a href="index.html">Goonstation 13</a> - <a href="index.html#modules">Modules</a> - <a href="index.html#types">Types</a> — <a href="datum/say_message.html#var">Var Details</a> - <a href="datum/say_message.html#proc">Proc Details</a></header><main><h1>/<a href="datum.html">datum</a>/<a href="datum/say_message.html">say_message</a> <img src="git.png" width="16" height="16" title="code/modules/speech/say_message.dm 7"></h1><p>The base message type; it contains the content of a message and all of the relevant metadata. Any text that has been passed
to <code>say()</code> is in turn passed into a new say message datum.</p><table class="summary" cellspacing="0"><tr><td colspan="2"><h2>Vars</h2></td></tr><tr><th><a href="datum/say_message.html#var/atom_listeners_override">atom_listeners_override</a></th><td>If set, this say message datum will be sent to these atoms as opposed to being broadcast over a say channel.</td></tr><tr><th><a href="datum/say_message.html#var/atom_listeners_to_be_excluded">atom_listeners_to_be_excluded</a></th><td>If set, and <code>atom_listeners_override</code> is not set, this say message datum will not be sent to the atoms in this list when being broadcast over a say channel. Note that this is an associative list.</td></tr><tr><th><a href="datum/say_message.html#var/can_relay">can_relay</a></th><td>If FALSE, this message will not be permitted to be retransmitted, regardless of the flags present in <code>relay_flags</code>.</td></tr><tr><th><a href="datum/say_message.html#var/card_ident">card_ident</a></th><td>The worn identity of the speaker, if they have one.</td></tr><tr><th><a href="datum/say_message.html#var/content">content</a></th><td>The sanitised and processed content of this message.</td></tr><tr><th><a href="datum/say_message.html#var/face_ident">face_ident</a></th><td>The facial identity of the speaker.</td></tr><tr><th><a href="datum/say_message.html#var/flags">flags</a></th><td>Message flags. See <code>_std/defines/speech_defines/sayflags.dm</code>.</td></tr><tr><th><a href="datum/say_message.html#var/format_content_prefix">format_content_prefix</a></th><td>The formatting that should immediately follow <code>say_verb</code> and precede <code>format_content_style_prefix</code>.</td></tr><tr><th><a href="datum/say_message.html#var/format_content_style_prefix">format_content_style_prefix</a></th><td>The formatting that should immediately follow <code>format_content_prefix</code> and precede <code>content</code>. Will be grouped with <code>content</code> in maptext.</td></tr><tr><th><a href="datum/say_message.html#var/format_content_style_suffix">format_content_style_suffix</a></th><td>The formatting that should immediately follow <code>content</code> and precede <code>format_content_suffix</code>. Will be grouped with <code>content</code> in maptext.</td></tr><tr><th><a href="datum/say_message.html#var/format_content_suffix">format_content_suffix</a></th><td>The formatting that should immediately follow <code>format_content_style_suffix</code>.</td></tr><tr><th><a href="datum/say_message.html#var/format_speaker_prefix">format_speaker_prefix</a></th><td>The formatting that should immediately precede <code>speaker_to_display</code>.</td></tr><tr><th><a href="datum/say_message.html#var/format_verb_prefix">format_verb_prefix</a></th><td>The formatting that should immediately follow <code>speaker_to_display</code> and precede <code>say_verb</code>.</td></tr><tr><th><a href="datum/say_message.html#var/hear_sound">hear_sound</a></th><td>The sound that should be played to listeners when this message is heard.</td></tr><tr><th><a href="datum/say_message.html#var/heard_range">heard_range</a></th><td>The range of a heard message.</td></tr><tr><th><a href="datum/say_message.html#var/id">id</a></th><td>The non-unique ID of this message. A listener may only hear one message of a specific ID at any time.</td></tr><tr><th><a href="datum/say_message.html#var/language">language</a></th><td>The language that this message was sent in.</td></tr><tr><th><a href="datum/say_message.html#var/last_character">last_character</a></th><td>The last character of this message. Used to determine messages intonation, i.e: &quot;?&quot; will result in a message being treated as a question.</td></tr><tr><th><a href="datum/say_message.html#var/loudness">loudness</a></th><td>How loud a message is determines how large it is displayed in the text window.</td></tr><tr><th><a href="datum/say_message.html#var/maptext_animation_colours">maptext_animation_colours</a></th><td>A list of colours for the maptext to oscillate through. Use the &quot;start_colour&quot; value to determine the colour to animate from to <code>maptext_css_values[&quot;color&quot;]</code>.</td></tr><tr><th><a href="datum/say_message.html#var/maptext_css_values">maptext_css_values</a></th><td>The CSS values for the maptext, stored as an associative list, i.e: &quot;font-weight&quot; = &quot;bold&quot;.</td></tr><tr><th><a href="datum/say_message.html#var/maptext_prefix">maptext_prefix</a></th><td>A prefix that should only be displayed on the maptext.</td></tr><tr><th><a href="datum/say_message.html#var/maptext_suffix">maptext_suffix</a></th><td>A suffix that should only be displayed on the maptext.</td></tr><tr><th><a href="datum/say_message.html#var/maptext_variables">maptext_variables</a></th><td>The variables for the maptext object, stored as an associative list, i.e: &quot;alpha&quot; = &quot;140&quot;.</td></tr><tr><th><a href="datum/say_message.html#var/message_origin">message_origin</a></th><td>The atom that should appear to have sent this message.</td></tr><tr><th><a href="datum/say_message.html#var/message_size_override">message_size_override</a></th><td>If set, overrides the <code>loudness</code> variable, and sets the font size of the message to the set value.</td></tr><tr><th><a href="datum/say_message.html#var/original_content">original_content</a></th><td>The original contents of this message, uneditied, unsanitised.</td></tr><tr><th><a href="datum/say_message.html#var/original_speaker">original_speaker</a></th><td>The atom that originally sent this message.</td></tr><tr><th><a href="datum/say_message.html#var/output_module_channel">output_module_channel</a></th><td>The channel that this radio message should attempt to be sent on. If <code>null</code>, will be sent to all available outputs.</td></tr><tr><th><a href="datum/say_message.html#var/output_module_override">output_module_override</a></th><td>If set, the output module that this message should attempt to be passed to.</td></tr><tr><th><a href="datum/say_message.html#var/prefix">prefix</a></th><td>The radio prefix that this message was sent with.</td></tr><tr><th><a href="datum/say_message.html#var/real_ident">real_ident</a></th><td>The real name of the speaker.</td></tr><tr><th><a href="datum/say_message.html#var/received_module">received_module</a></th><td>The input module that received this message last.</td></tr><tr><th><a href="datum/say_message.html#var/relay_flags">relay_flags</a></th><td>A bitflag of the various way that this message has been retransmitted. Used to prevent feedback loops.</td></tr><tr><th><a href="datum/say_message.html#var/say_sound">say_sound</a></th><td>The sound that should play when this message is spoken.</td></tr><tr><th><a href="datum/say_message.html#var/say_verb">say_verb</a></th><td>The verb to display when this message is received, i.e: &quot;Jeff [say_verb], [message]&quot;</td></tr><tr><th><a href="datum/say_message.html#var/signal_recipient">signal_recipient</a></th><td>The datum that should act as a signal recipient for every copy of this message.</td></tr><tr><th><a href="datum/say_message.html#var/speaker">speaker</a></th><td>The atom that sent this message.</td></tr><tr><th><a href="datum/say_message.html#var/speaker_location_text">speaker_location_text</a></th><td>The text indicating where this message was spoken from, if it was spoken from inside of an object.</td></tr><tr><th><a href="datum/say_message.html#var/speaker_to_display">speaker_to_display</a></th><td>The name of the speaker that should be used when displaying the message to a listener. If null, defaults to the <code>speaker</code> atom.</td></tr><tr><th><a href="datum/say_message.html#var/voice_ident">voice_ident</a></th><td>The voice identity of the speaker.</td></tr><tr><th><a href="datum/say_message.html#var/whisper_verb">whisper_verb</a></th><td>The verb to display when this message is received, if it is whispered.</td></tr><tr><td colspan="2"><h2>Procs</h2></td></tr><tr><th><a href="datum/say_message.html#proc/Copy">Copy</a></th><td>Create a copy of this say message datum.</td></tr><tr><th><a href="datum/say_message.html#proc/format_for_output">format_for_output</a></th><td>Returns a formatted message for use with <code>boutput()</code>, using either the last listen input module or falling back to the default format of <code>&quot;[speaker] [say_verb], [content]&quot;</code>.</td></tr><tr><th><a href="datum/say_message.html#proc/get_speaker_name">get_speaker_name</a></th><td>Returns the heard name of the speaker, taking into account masks, voice changers, and IDs.</td></tr><tr><th><a href="datum/say_message.html#proc/make_safe_for_chat">make_safe_for_chat</a></th><td>Removes forbidden characters, newlines, tabs, and HTML tags from a message, and checks for URLs.</td></tr><tr><th><a href="datum/say_message.html#proc/process_say_sound">process_say_sound</a></th><td>Determines the say sound that this message should use, and plays it.</td></tr><tr><th><a href="datum/say_message.html#proc/process_speech_bubble">process_speech_bubble</a></th><td>Determines the speech bubble that this message should use, and displays it on the speaker.</td></tr><tr><th><a href="datum/say_message.html#proc/run_mob_and_client_checks">run_mob_and_client_checks</a></th><td>Checks whether the mob or client is muted, and applies preference data to the message's content.</td></tr></table><h2 id="var">Var Details</h2><h3 id="var/atom_listeners_override"><aside class="declaration">var </aside>atom_listeners_override <aside>– /list/<a href="atom.html">atom</a></aside> <img src="git.png" width="16" height="16" title="code/modules/speech/say_message.dm 80"></h3><p>If set, this say message datum will be sent to these atoms as opposed to being broadcast over a say channel.</p><h3 id="var/atom_listeners_to_be_excluded"><aside class="declaration">var </aside>atom_listeners_to_be_excluded <aside>– /list/<a href="atom.html">atom</a></aside> <img src="git.png" width="16" height="16" title="code/modules/speech/say_message.dm 82"></h3><p>If set, and <code>atom_listeners_override</code> is not set, this say message datum will not be sent to the atoms in this list when being broadcast over a say channel. Note that this is an associative list.</p><h3 id="var/can_relay"><aside class="declaration">var </aside>can_relay <img src="git.png" width="16" height="16" title="code/modules/speech/say_message.dm 86"></h3><p>If FALSE, this message will not be permitted to be retransmitted, regardless of the flags present in <code>relay_flags</code>.</p><h3 id="var/card_ident"><aside class="declaration">var </aside>card_ident <img src="git.png" width="16" height="16" title="code/modules/speech/say_message.dm 44"></h3><p>The worn identity of the speaker, if they have one.</p><h3 id="var/content"><aside class="declaration">var </aside>content <img src="git.png" width="16" height="16" title="code/modules/speech/say_message.dm 14"></h3><p>The sanitised and processed content of this message.</p><h3 id="var/face_ident"><aside class="declaration">var </aside>face_ident <img src="git.png" width="16" height="16" title="code/modules/speech/say_message.dm 42"></h3><p>The facial identity of the speaker.</p><h3 id="var/flags"><aside class="declaration">var </aside>flags <img src="git.png" width="16" height="16" title="code/modules/speech/say_message.dm 56"></h3><p>Message flags. See <code>_std/defines/speech_defines/sayflags.dm</code>.</p><h3 id="var/format_content_prefix"><aside class="declaration">var </aside>format_content_prefix <img src="git.png" width="16" height="16" title="code/modules/speech/say_message.dm 24"></h3><p>The formatting that should immediately follow <code>say_verb</code> and precede <code>format_content_style_prefix</code>.</p><h3 id="var/format_content_style_prefix"><aside class="declaration">var </aside>format_content_style_prefix <img src="git.png" width="16" height="16" title="code/modules/speech/say_message.dm 26"></h3><p>The formatting that should immediately follow <code>format_content_prefix</code> and precede <code>content</code>. Will be grouped with <code>content</code> in maptext.</p><h3 id="var/format_content_style_suffix"><aside class="declaration">var </aside>format_content_style_suffix <img src="git.png" width="16" height="16" title="code/modules/speech/say_message.dm 28"></h3><p>The formatting that should immediately follow <code>content</code> and precede <code>format_content_suffix</code>. Will be grouped with <code>content</code> in maptext.</p><h3 id="var/format_content_suffix"><aside class="declaration">var </aside>format_content_suffix <img src="git.png" width="16" height="16" title="code/modules/speech/say_message.dm 30"></h3><p>The formatting that should immediately follow <code>format_content_style_suffix</code>.</p><h3 id="var/format_speaker_prefix"><aside class="declaration">var </aside>format_speaker_prefix <img src="git.png" width="16" height="16" title="code/modules/speech/say_message.dm 20"></h3><p>The formatting that should immediately precede <code>speaker_to_display</code>.</p><h3 id="var/format_verb_prefix"><aside class="declaration">var </aside>format_verb_prefix <img src="git.png" width="16" height="16" title="code/modules/speech/say_message.dm 22"></h3><p>The formatting that should immediately follow <code>speaker_to_display</code> and precede <code>say_verb</code>.</p><h3 id="var/hear_sound"><aside class="declaration">var </aside>hear_sound <img src="git.png" width="16" height="16" title="code/modules/speech/say_message.dm 60"></h3><p>The sound that should be played to listeners when this message is heard.</p><h3 id="var/heard_range"><aside class="declaration">var </aside>heard_range <img src="git.png" width="16" height="16" title="code/modules/speech/say_message.dm 64"></h3><p>The range of a heard message.</p><h3 id="var/id"><aside class="declaration">var </aside>id <img src="git.png" width="16" height="16" title="code/modules/speech/say_message.dm 50"></h3><p>The non-unique ID of this message. A listener may only hear one message of a specific ID at any time.</p><h3 id="var/language"><aside class="declaration">var </aside>language <aside>– /<a href="datum.html">datum</a>/<a href="datum/language.html">language</a></aside> <img src="git.png" width="16" height="16" title="code/modules/speech/say_message.dm 62"></h3><p>The language that this message was sent in.</p><h3 id="var/last_character"><aside class="declaration">var </aside>last_character <img src="git.png" width="16" height="16" title="code/modules/speech/say_message.dm 72"></h3><p>The last character of this message. Used to determine messages intonation, i.e: &quot;?&quot; will result in a message being treated as a question.</p><h3 id="var/loudness"><aside class="declaration">var </aside>loudness <img src="git.png" width="16" height="16" title="code/modules/speech/say_message.dm 66"></h3><p>How loud a message is determines how large it is displayed in the text window.</p><h3 id="var/maptext_animation_colours"><aside class="declaration">var </aside>maptext_animation_colours <aside>– /list</aside> <img src="git.png" width="16" height="16" title="code/modules/speech/say_message.dm 100"></h3><p>A list of colours for the maptext to oscillate through. Use the &quot;start_colour&quot; value to determine the colour to animate from to <code>maptext_css_values[&quot;color&quot;]</code>.</p><h3 id="var/maptext_css_values"><aside class="declaration">var </aside>maptext_css_values <aside>– /list</aside> <img src="git.png" width="16" height="16" title="code/modules/speech/say_message.dm 90"></h3><p>The CSS values for the maptext, stored as an associative list, i.e: &quot;font-weight&quot; = &quot;bold&quot;.</p><h3 id="var/maptext_prefix"><aside class="declaration">var </aside>maptext_prefix <img src="git.png" width="16" height="16" title="code/modules/speech/say_message.dm 102"></h3><p>A prefix that should only be displayed on the maptext.</p><h3 id="var/maptext_suffix"><aside class="declaration">var </aside>maptext_suffix <img src="git.png" width="16" height="16" title="code/modules/speech/say_message.dm 104"></h3><p>A suffix that should only be displayed on the maptext.</p><h3 id="var/maptext_variables"><aside class="declaration">var </aside>maptext_variables <aside>– /list</aside> <img src="git.png" width="16" height="16" title="code/modules/speech/say_message.dm 92"></h3><p>The variables for the maptext object, stored as an associative list, i.e: &quot;alpha&quot; = &quot;140&quot;.</p><h3 id="var/message_origin"><aside class="declaration">var </aside>message_origin <aside>– /<a href="atom.html">atom</a></aside> <img src="git.png" width="16" height="16" title="code/modules/speech/say_message.dm 38"></h3><p>The atom that should appear to have sent this message.</p><h3 id="var/message_size_override"><aside class="declaration">var </aside>message_size_override <img src="git.png" width="16" height="16" title="code/modules/speech/say_message.dm 68"></h3><p>If set, overrides the <code>loudness</code> variable, and sets the font size of the message to the set value.</p><h3 id="var/original_content"><aside class="declaration">var </aside>original_content <img src="git.png" width="16" height="16" title="code/modules/speech/say_message.dm 54"></h3><p>The original contents of this message, uneditied, unsanitised.</p><h3 id="var/original_speaker"><aside class="declaration">var </aside>original_speaker <aside>– /<a href="atom.html">atom</a></aside> <img src="git.png" width="16" height="16" title="code/modules/speech/say_message.dm 36"></h3><p>The atom that originally sent this message.</p><h3 id="var/output_module_channel"><aside class="declaration">var </aside>output_module_channel <img src="git.png" width="16" height="16" title="code/modules/speech/say_message.dm 74"></h3><p>The channel that this radio message should attempt to be sent on. If <code>null</code>, will be sent to all available outputs.</p><h3 id="var/output_module_override"><aside class="declaration">var </aside>output_module_override <img src="git.png" width="16" height="16" title="code/modules/speech/say_message.dm 76"></h3><p>If set, the output module that this message should attempt to be passed to.</p><h3 id="var/prefix"><aside class="declaration">var </aside>prefix <img src="git.png" width="16" height="16" title="code/modules/speech/say_message.dm 70"></h3><p>The radio prefix that this message was sent with.</p><h3 id="var/real_ident"><aside class="declaration">var </aside>real_ident <img src="git.png" width="16" height="16" title="code/modules/speech/say_message.dm 46"></h3><p>The real name of the speaker.</p><h3 id="var/received_module"><aside class="declaration">var </aside>received_module <aside>– /<a href="datum.html">datum</a>/<a href="datum/listen_module.html">listen_module</a>/<a href="datum/listen_module/input.html">input</a></aside> <img src="git.png" width="16" height="16" title="code/modules/speech/say_message.dm 78"></h3><p>The input module that received this message last.</p><h3 id="var/relay_flags"><aside class="declaration">var </aside>relay_flags <img src="git.png" width="16" height="16" title="code/modules/speech/say_message.dm 84"></h3><p>A bitflag of the various way that this message has been retransmitted. Used to prevent feedback loops.</p><h3 id="var/say_sound"><aside class="declaration">var </aside>say_sound <img src="git.png" width="16" height="16" title="code/modules/speech/say_message.dm 58"></h3><p>The sound that should play when this message is spoken.</p><h3 id="var/say_verb"><aside class="declaration">var </aside>say_verb <img src="git.png" width="16" height="16" title="code/modules/speech/say_message.dm 16"></h3><p>The verb to display when this message is received, i.e: &quot;Jeff [say_verb], [message]&quot;</p><h3 id="var/signal_recipient"><aside class="declaration">var </aside>signal_recipient <aside>– /<a href="datum.html">datum</a></aside> <img src="git.png" width="16" height="16" title="code/modules/speech/say_message.dm 52"></h3><p>The datum that should act as a signal recipient for every copy of this message.</p><h3 id="var/speaker"><aside class="declaration">var </aside>speaker <aside>– /<a href="atom.html">atom</a></aside> <img src="git.png" width="16" height="16" title="code/modules/speech/say_message.dm 34"></h3><p>The atom that sent this message.</p><h3 id="var/speaker_location_text"><aside class="declaration">var </aside>speaker_location_text <img src="git.png" width="16" height="16" title="code/modules/speech/say_message.dm 12"></h3><p>The text indicating where this message was spoken from, if it was spoken from inside of an object.</p><h3 id="var/speaker_to_display"><aside class="declaration">var </aside>speaker_to_display <img src="git.png" width="16" height="16" title="code/modules/speech/say_message.dm 10"></h3><p>The name of the speaker that should be used when displaying the message to a listener. If null, defaults to the <code>speaker</code> atom.</p><h3 id="var/voice_ident"><aside class="declaration">var </aside>voice_ident <img src="git.png" width="16" height="16" title="code/modules/speech/say_message.dm 40"></h3><p>The voice identity of the speaker.</p><h3 id="var/whisper_verb"><aside class="declaration">var </aside>whisper_verb <img src="git.png" width="16" height="16" title="code/modules/speech/say_message.dm 18"></h3><p>The verb to display when this message is received, if it is whispered.</p><h2 id="proc">Proc Details</h2><h3 id="proc/Copy"><aside class="declaration">proc </aside>Copy<aside>() <span class="as"> as </span>/<a href="datum.html">datum</a>/<a href="datum/say_message.html">say_message</a> <img src="git.png" width="16" height="16" title="code/modules/speech/say_message.dm 389"></aside></h3><p>Create a copy of this say message datum.</p><h3 id="proc/format_for_output"><aside class="declaration">proc </aside>format_for_output<aside>(/<a href="atom.html">atom</a>/listener)  <img src="git.png" width="16" height="16" title="code/modules/speech/say_message.dm 305"></aside></h3><p>Returns a formatted message for use with <code>boutput()</code>, using either the last listen input module or falling back to the default format of <code>&quot;[speaker] [say_verb], [content]&quot;</code>.</p><h3 id="proc/get_speaker_name"><aside class="declaration">proc </aside>get_speaker_name<aside>(heard_name_only)  <img src="git.png" width="16" height="16" title="code/modules/speech/say_message.dm 361"></aside></h3><p>Returns the heard name of the speaker, taking into account masks, voice changers, and IDs.</p><h3 id="proc/make_safe_for_chat"><aside class="declaration">proc </aside>make_safe_for_chat<aside>(message<span class="as"> as </span>text)  <img src="git.png" width="16" height="16" title="code/modules/speech/say_message.dm 205"></aside></h3><p>Removes forbidden characters, newlines, tabs, and HTML tags from a message, and checks for URLs.</p><h3 id="proc/process_say_sound"><aside class="declaration">proc </aside>process_say_sound<aside>()  <img src="git.png" width="16" height="16" title="code/modules/speech/say_message.dm 244"></aside></h3><p>Determines the say sound that this message should use, and plays it.</p><h3 id="proc/process_speech_bubble"><aside class="declaration">proc </aside>process_speech_bubble<aside>()  <img src="git.png" width="16" height="16" title="code/modules/speech/say_message.dm 279"></aside></h3><p>Determines the speech bubble that this message should use, and displays it on the speaker.</p><h3 id="proc/run_mob_and_client_checks"><aside class="declaration">proc </aside>run_mob_and_client_checks<aside>()  <img src="git.png" width="16" height="16" title="code/modules/speech/say_message.dm 227"></aside></h3><p>Checks whether the mob or client is muted, and applies preference data to the message's content.</p></main><footer>goonstation.dme e18c4efa8a3ab2e13df0a169b767dbc7355e7294 — <a href="https://github.com/SpaceManiac/SpacemanDMM/blob/master/crates/dmdoc/README.md">dmdoc 1.10.0</a></footer></body></html>